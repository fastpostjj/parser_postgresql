# Парсер вакансий

Проект __Парсер вакансий__ создан для работы с API сайта hh.ru.
Полученные данные с сайта hh.ru сохраняются в базу данных Posgresql название базы данных - __vacancies__.
Для заполнения базы данных требуется файл __data\favorits_employers.json__, содержащий список работодателей в формате json, для которых будет формироваться запрос к сайту hh.ru.

Пример файла:

    [
        {"id": "3529", "name": "СБЕР"},
        {"id": "2180", "name": "Ozon"},
        {"id": "9211299", "name": "Онлайн-школа программирования КиберУм"},
        {"id": "2657797", "name": "Алгоритмика"}
    ]
Поле id является обязательным, т. к по id осуществляется поиск работодателя.

Для корректного подключения к базе данных настройки для подключения должны находится в файле
__database.ini__ в корневом каталоге проекта. Файл дожен иметь следующую структуру:

    [postgresql]
        host=<имя хоста>
        user=<имя пользователя базы данных>
        password=<пароль>
        port=<порт>

Для работы проекта реализованы следующие классы.


## Класс DBManager
__Класс DBManager__ служит для подключения к БД Postgres.
По умолчанию название базы данных - vacancies. Любое  другое можно задать при инициализации, передав параметр database_name.
Параметры инициализации базы данных задаются в файле database.ini.

Методы:
*   get_companies_and_vacancies_count(): получает список всех компаний
     и количество вакансий у каждой компании.
*   get_all_vacancies(): получает список всех вакансий с указанием
     названия компании, названия вакансии и зарплаты и ссылки на вакансию.
*   get_avg_salary(): получает среднюю зарплату по вакансиям.
*   get_vacancies_with_higher_salary(): получает список всех вакансий,
     у которых зарплата выше средней по всем вакансиям.
*   get_vacancies_with_keyword(): получает список всех вакансий,
     в названии которых содержатся переданные в метод слова, например 'python'.
*   _print_table() - печатает все данные из таблицы, название которой в нее
    передано

## Класс Connector
__Класс Connector__ реализует доступ к файлу. Инициализируется строкой, содержащей путь к файлу. Файл должен содержать данные в json формате.

Methods:
*   is_valid_json: bool - проверят, является ли файл JSON.
*   is_file_exist: bool - проверяет существует ли файл
*   read_file: str - получает текст из файла
*   is_file_not_old: bool - проверяет дату создания файла (больше заданого числа дней)
*   save_date: str - сохраняет данные в файл
*   insert: dict | list - вставляет данные в файл с сохранением их структуры
*   select: list | KeyError - выбирает данные из файла по ключу.
*   delete: list | KeyError - удаляет данные используя запрос
*   insert_only_unic() -> str: добавляет данные только если данные с таким id не содержатся в файле. Иначе выбрасывает исключение.



## Класс Vacancy
__Класс Vacancy__ представляет объект для работы с вакансией.

Atributes:

*   id:int -  id вакансии на сайте,
*   title:str - название вакансии,
*   salary_from: float - минимальный уровень зарплаты,
*   salary_to: float - максимальный уровень зарплаты,
*   url:str - ссылка,
*   description:str -  описание,
*   firm_name:str - название работодателя,
*   service:str- название сайта, откуда взята вакансия.
    Принимает значения HH или SJ.

## Класс HH
__Класс HH__ создан для работы с сайтом hh.ru.

Methods:

*   get_request() - получает данные с сайта hh.ru в формате json
*   get_connector() -> возвращает экземпляр класса Connector

## Класс HH_sql
__Класс HH_sql__ унаследован от класса HH.

Методы, которые были добавлены::

*   get_connectordb(file_name: str) -> DBmanager:
        возвращает экземпляр класса DBmanager

*   get_request_employers_vacancies() -> list:
    Возвращает список вакансий для данного работодателя по его id.

*   get_request_employers() -> dict:
    Возвращает данные для работодателя по его id



## Класс NoVacationError
__Класс NoVacationError__ создан для обработки исключения, которое выбрасывается в случае, если при запросе к сайту с вакансиями ни одна не найдена.

## Класс Employer
__Класс Employer__ для представления данных работодателя

Атрибуты:
*   id - id работодатея на сайте hh.ru
*   name - название работодателя
*   description - описание
*   url - ссылка
*   alternate_url - альтернативная ссылка
*   trusted - признак проверки


## Функции
*   def get_employer_from_json(data: dict) -> Employer:
    функция получает словарь и возвращает объект Employer, заполненный данными из словаря
*   get_vacancy_from_json(vacancy: dict) -> Vacancy_sql:
функция возвращает объект Vacancy_sql, заполненный данными из словаря

## Работа с программой

При запуске появляется меню

    ------Парсер вакансий------
    1 - Сделать запрос на сайт hh.ru по списку работодателей и сохранить данные в базе данных
    2 - Получить данные из базы данных
    3 - Выход.

При выборе пункта 1 будeт выполнен запрос на сайт hh.ru для работодателей из файла data\favorits_ employers.json.


При выборе пункта 2 появится меню

    Выберите нужное действие:
    1 - Посчитать вакансии у каждого работодателя
    2 - Вывести среднюю зарплату
    3 - Вывести список всех вакансий
    4 - Вывести список всех вакансий, у которых зарплата выше средней
    5 - Вывести список всех вакансий, в названии которых содержится ключевое слово
    6 - Возврат в главное меню.